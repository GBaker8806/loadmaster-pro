<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loadmaster Pro</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <style>
    body {
      background-color: #121212;
      color: #e0e0e0;
      font-family: 'Segoe UI', sans-serif;
      padding: 1rem;
    }
    .module-icon {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 2px solid #444;
      border-radius: 16px;
      padding: 1rem;
      background-color: #1e1e1e;
      transition: background-color 0.2s ease;
      cursor: pointer;
    }
    .module-icon:hover {
      background-color: #2a2a2a;
    }
    .icon-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 1rem;
      margin-top: 2rem;
    }
    h1 {
      text-align: center;
      color: #99e1d9;
    }
    .icon-label {
      margin-top: 0.5rem;
      text-align: center;
    }
    .module-content {
      margin-top: 2rem;
      border-top: 1px solid #444;
      padding-top: 1rem;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Loadmaster Pro</h1>
  <div class="icon-grid">
    <div class="module-icon" onclick="showModule('restraint')">
      <div style="font-size: 2rem">üîó</div>
      <div class="icon-label">Restraint</div>
    </div>
    <div class="module-icon" onclick="showModule('loadshift')">
      <div style="font-size: 2rem">üì¶</div>
      <div class="icon-label">Load Shift</div>
    </div>
    <div class="module-icon" onclick="showModule('winching')">
      <div style="font-size: 2rem">üß≤</div>
      <div class="icon-label">Winching</div>
    </div>
    <div class="module-icon" onclick="showModule('psi')">
      <div style="font-size: 2rem">üìè</div>
      <div class="icon-label">PSI/Shoring</div>
    </div>
    <div class="module-icon" onclick="showModule('vehiclecg')">
      <div style="font-size: 2rem">üöö</div>
      <div class="icon-label">Vehicle CG</div>
    </div>
    <div class="module-icon" onclick="showModule('weightbalance')">
      <div style="font-size: 2rem">‚öñÔ∏è</div>
      <div class="icon-label">W&B + MAC</div>
    </div>
  </div>

  <div id="restraint" class="module-content hidden">
  <h2>Restraint Module</h2>
  <div class="mb-3">
    <label for="restraintWeight" class="form-label">Cargo Weight (lbs)</label>
    <input type="number" id="restraintWeight" class="form-control" />
  </div>
  <button class="btn btn-primary mb-3" onclick="calculateRequiredRestraint()">Calculate Required Restraint</button>
  <div id="requiredRestraintResult" class="mb-3"></div>

  <div id="actualRestraintSection" style="display:none">
    <div class="mb-3">
      <label for="restraintDirection" class="form-label">Direction</label>
      <select id="restraintDirection" class="form-select">
        <option value="FWD">Forward</option>
        <option value="AFT">Aft</option>
        <option value="LEFT">Left (Lateral)</option>
        <option value="RIGHT">Right (Lateral)</option>
        <option value="VERT">Vertical</option>
      </select>
    </div>
    <div class="mb-3">
      <label for="actualLength" class="form-label">Actual Length (in)</label>
      <input type="number" id="actualLength" class="form-control" />
    </div>
    <div class="mb-3">
      <label for="effectiveLength" class="form-label">Effective Length (in)</label>
      <input type="number" id="effectiveLength" class="form-control" />
    </div>
    <div class="mb-3">
      <label for="restraintFactor" class="form-label">Restraint Factor</label>
      <select id="restraintFactor" class="form-select">
        <option value="5000">5,000</option>
        <option value="10000" selected>10,000</option>
        <option value="25000">25,000</option>
      </select>
    </div>
    <div class="mb-3 text-center">
      <button id="toggleDouble" class="btn btn-outline-info" onclick="toggleMultiplier(this)">Multiply by 2: OFF</button>
    </div>
    <button class="btn btn-success mb-3" onclick="calculateActualRestraint()">Add Restraint</button>
    <button class="btn btn-danger mb-3" onclick="undoLastRestraint()">Undo Last</button>
    <button class="btn btn-secondary mb-3" onclick="clearAllRestraint()">Clear All</button>

    <div id="actualRestraintTotals" class="mt-3"></div>
  </div>
</div>
<script>
  let restraintTotals = { FWD: 0, AFT: 0, LEFT: 0, RIGHT: 0, VERT: 0 };
  let restraintHistory = [];
  let multiplier = 1;

  function calculateRequiredRestraint() {
    const weight = parseFloat(document.getElementById('restraintWeight').value);
    if (isNaN(weight)) return;
    const gForces = { FWD: 3.0, AFT: 1.5, LEFT: 1.5, RIGHT: 1.5, VERT: 2.0 };
    let output = `<strong>Required Restraint:</strong><br/>`;
    const lat = Math.round(weight * gForces.LEFT); // LEFT and RIGHT use same factor
    output += `FWD: ${Math.round(weight * gForces.FWD)} lbs<br/>`;
    output += `AFT: ${Math.round(weight * gForces.AFT)} lbs<br/>`;
    output += `LAT: ${lat} lbs<br/>`;
    output += `VERT: ${Math.round(weight * gForces.VERT)} lbs<br/>`;
    document.getElementById('requiredRestraintResult').innerHTML = output;
    document.getElementById('actualRestraintSection').style.display = 'block';
  }

  function toggleMultiplier(btn) {
    multiplier = multiplier === 1 ? 2 : 1;
    btn.innerText = `Multiply by 2: ${multiplier === 2 ? 'ON' : 'OFF'}`;
  }

  function calculateActualRestraint() {
    const actual = parseFloat(document.getElementById('actualLength').value);
    const effective = parseFloat(document.getElementById('effectiveLength').value);
    const factor = parseFloat(document.getElementById('restraintFactor').value);
    const direction = document.getElementById('restraintDirection').value;
    if (isNaN(actual) || isNaN(effective) || actual === 0) return;
    let result = (effective / actual) * factor * multiplier;
    result = Math.round(result);
    restraintTotals[direction] += result;
    restraintHistory.push({ direction, value: result });
    updateRestraintTotals();
  }

  function undoLastRestraint() {
    const last = restraintHistory.pop();
    if (last) {
      restraintTotals[last.direction] -= last.value;
      updateRestraintTotals();
    }
  }

  function clearAllRestraint() {
    restraintTotals = { FWD: 0, AFT: 0, LEFT: 0, RIGHT: 0, VERT: 0 };
    restraintHistory = [];
    updateRestraintTotals();
  }

  function updateRestraintTotals() {
    const display = Object.entries(restraintTotals).map(([dir, val]) => `${dir}: ${val} lbs`).join('<br/>');
    document.getElementById('actualRestraintTotals').innerHTML = `<strong>Current Actual Totals:</strong><br/>${display}`;
  }
</script>
  <div id="loadshift" class="module-content hidden">
  <h2>Load Shift Module</h2>
  <div class="mb-3">
    <label for="shiftArm" class="form-label">Load Shift Arm (in)</label>
    <input type="number" id="shiftArm" class="form-control" />
  </div>
  <div class="mb-3">
    <label for="shiftWeight" class="form-label">Load Shift Weight (lbs)</label>
    <input type="number" id="shiftWeight" class="form-control" />
  </div>
  <div class="mb-3">
    <label for="shiftGross" class="form-label">Aircraft Gross Weight (lbs)</label>
    <input type="number" id="shiftGross" class="form-control" />
  </div>
  <div class="mb-3">
    <label for="cgChange" class="form-label">CG Change (in)</label>
    <input type="number" id="cgChange" class="form-control" />
  </div>
  <button class="btn btn-primary mb-3" onclick="calculateLoadShift()">Calculate</button>
  <div id="loadShiftResult"></div>
</div>
<script>
  function calculateLoadShift() {
    const shiftArm = parseFloat(document.getElementById('shiftArm').value);
    const shiftWeight = parseFloat(document.getElementById('shiftWeight').value);
    const shiftGross = parseFloat(document.getElementById('shiftGross').value);
    const cgChange = parseFloat(document.getElementById('cgChange').value);

    const inputs = [shiftArm, shiftWeight, shiftGross, cgChange];
    const missing = inputs.filter(v => isNaN(v));
    let result = '';

    if (missing.length !== 1) {
      result = 'Please leave exactly one field blank to solve for it.';
    } else if (isNaN(shiftArm)) {
      result = `Shift Arm = ${(cgChange * shiftGross / shiftWeight).toFixed(1)} in`;
    } else if (isNaN(shiftWeight)) {
      result = `Shift Weight = ${(cgChange * shiftGross / shiftArm).toFixed(1)} lbs`;
    } else if (isNaN(shiftGross)) {
      result = `Gross Weight = ${(cgChange * shiftWeight / shiftArm).toFixed(1)} lbs`;
    } else if (isNaN(cgChange)) {
      result = `CG Change = ${(shiftArm * shiftWeight / shiftGross).toFixed(1)} in`;
    }

    document.getElementById('loadShiftResult').innerText = result;
  }
</script>
  <div id="winching" class="module-content hidden">
    <h2>Winching Module</h2>
    <p>üîß Embedded Winching calculator will go here.</p>
  </div>
  <div id="psi" class="module-content hidden">
    <h2>PSI/Shoring Module</h2>
    <p>üîß Embedded PSI/Shoring calculator will go here.</p>
  </div>
  <div id="vehiclecg" class="module-content hidden">
    <h2>Vehicle CG Module</h2>
    <p>üîß Embedded Vehicle CG calculator will go here.</p>
  </div>
  <div id="weightbalance" class="module-content hidden">
    <h2>Weight & Balance Module</h2>
    <p>üîß Embedded W&B and MAC calculator will go here.</p>
  </div>

  <script>
    function showModule(name) {
      document.querySelectorAll('.module-content').forEach(el => el.classList.add('hidden'));
      document.getElementById(name).classList.remove('hidden');
      window.scrollTo({ top: document.getElementById(name).offsetTop, behavior: 'smooth' });
    }
  </script>
</body>
</html>